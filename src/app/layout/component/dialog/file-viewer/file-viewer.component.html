<p-dialog [(visible)]="visible" [header]="header" [modal]="true" [style]="{ width: '50vw' }"
          [breakpoints]="{ '960px': '75vw', '640px': '90vw' }" (onHide)="visibleChange.emit(false)">
    <div class="file-list">
        @if (files && files.length > 0) {
            <div class="flex flex-col gap-2">
                @for (file of files; track file.id || $index) {
                    <a [href]="getFileUrl(file)" target="_blank" rel="noopener noreferrer" class="file-item-link">
                        <div class="flex items-center gap-4 p-3 rounded-border border border-surface transition-colors">
                            <!-- Left: Icon, Image, or Video -->
                            <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center">
                                @if (isImageFile(file.file_name)) {
                                    <img [src]="getFileUrl(file)" [alt]="file.file_name"
                                         class="w-12 h-12 rounded object-contain" />
                                } @else if (isVideoFile(file.file_name)) {
                                    <video [src]="getFileUrl(file)" class="w-12 h-12 rounded object-cover"
                                           muted></video>
                                } @else {
                                    <i [class]="getFileIcon(file.file_name)" class="text-3xl"></i>
                                }
                            </div>

                            <!-- Middle: File name and size -->
                            <div class="flex-1 min-w-0">
                                <div class="font-semibold text-ellipsis whitespace-nowrap overflow-hidden">
                                    {{ file.file_name || 'Файл' }}
                                </div>
                                @if (file.size_bytes) {
                                    <div class="text-sm text-color-secondary">{{ formatFileSize(file.size_bytes) }}
                                    </div>
                                }
                            </div>

                            <!-- Right: Download icon -->
                            <div class="flex-shrink-0">
                                <i class="pi pi-external-link text-primary-500 px-4"></i>
                            </div>
                        </div>
                    </a>
                }
            </div>
        } @else {
            <p class="no-files">Нет прикрепленных файлов</p>
        }
    </div>
</p-dialog>
