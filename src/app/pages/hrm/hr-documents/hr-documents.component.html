<div class="hr-documents-container">
    <!-- Header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
        <div>
            <h1 class="text-2xl font-bold text-surface-900 dark:text-surface-0 m-0">{{ 'HRM.DOCUMENTS.TITLE' | translate }}</h1>
            <p class="text-surface-600 dark:text-surface-400 mt-1">{{ 'HRM.DOCUMENTS.SUBTITLE' | translate }}</p>
        </div>
        <div class="flex gap-2">
            <button pButton [label]="'HRM.DOCUMENTS.NEW_DOCUMENT' | translate" icon="pi pi-plus" (click)="openNewDocumentDialog()"></button>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
        <div class="bg-surface-0 dark:bg-surface-800 rounded-lg p-4 border border-surface-200 dark:border-surface-700">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                    <i class="pi pi-file text-blue-600 dark:text-blue-400 text-xl"></i>
                </div>
                <div>
                    <p class="text-surface-500 dark:text-surface-400 text-sm m-0">{{ 'HRM.DOCUMENTS.TOTAL_DOCUMENTS' | translate }}</p>
                    <p class="text-2xl font-bold text-surface-900 dark:text-surface-0 m-0">{{ stats.total_documents }}</p>
                </div>
            </div>
        </div>

        <div class="bg-surface-0 dark:bg-surface-800 rounded-lg p-4 border border-surface-200 dark:border-surface-700">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center">
                    <i class="pi pi-clock text-orange-600 dark:text-orange-400 text-xl"></i>
                </div>
                <div>
                    <p class="text-surface-500 dark:text-surface-400 text-sm m-0">{{ 'HRM.DOCUMENTS.PENDING_SIGNATURES' | translate }}</p>
                    <p class="text-2xl font-bold text-surface-900 dark:text-surface-0 m-0">{{ stats.pending_signatures }}</p>
                </div>
            </div>
        </div>

        <div class="bg-surface-0 dark:bg-surface-800 rounded-lg p-4 border border-surface-200 dark:border-surface-700 cursor-pointer hover:border-primary-500 transition-colors">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
                    <i class="pi pi-pencil text-red-600 dark:text-red-400 text-xl"></i>
                </div>
                <div>
                    <p class="text-surface-500 dark:text-surface-400 text-sm m-0">{{ 'HRM.DOCUMENTS.AWAITING_MY_SIGNATURE' | translate }}</p>
                    <p class="text-2xl font-bold text-surface-900 dark:text-surface-0 m-0">{{ stats.my_pending_signatures }}</p>
                </div>
            </div>
        </div>

        <div class="bg-surface-0 dark:bg-surface-800 rounded-lg p-4 border border-surface-200 dark:border-surface-700">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center">
                    <i class="pi pi-exclamation-triangle text-yellow-600 dark:text-yellow-400 text-xl"></i>
                </div>
                <div>
                    <p class="text-surface-500 dark:text-surface-400 text-sm m-0">{{ 'HRM.DOCUMENTS.EXPIRING_SOON' | translate }}</p>
                    <p class="text-2xl font-bold text-surface-900 dark:text-surface-0 m-0">{{ stats.expiring_soon }}</p>
                </div>
            </div>
        </div>

        <div class="bg-surface-0 dark:bg-surface-800 rounded-lg p-4 border border-surface-200 dark:border-surface-700">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center">
                    <i class="pi pi-inbox text-purple-600 dark:text-purple-400 text-xl"></i>
                </div>
                <div>
                    <p class="text-surface-500 dark:text-surface-400 text-sm m-0">{{ 'HRM.DOCUMENTS.REQUESTS' | translate }}</p>
                    <p class="text-2xl font-bold text-surface-900 dark:text-surface-0 m-0">{{ stats.requests_pending }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabs -->
    <p-tabs [value]="activeTabIndex" (valueChange)="onTabChange($event)">
        <p-tablist>
            <p-tab [value]="0">
                <i class="pi pi-file mr-2"></i>
                {{ 'HRM.DOCUMENTS.DOCUMENTS_TAB' | translate }}
            </p-tab>
            <p-tab [value]="1">
                <i class="pi pi-inbox mr-2"></i>
                {{ 'HRM.DOCUMENTS.REQUESTS_TAB' | translate }}
            </p-tab>
        </p-tablist>

        <p-tabpanels>
            <!-- Documents Tab -->
            <p-tabpanel [value]="0">
                <!-- Filters -->
                <div class="bg-surface-0 dark:bg-surface-800 rounded-lg p-4 mb-4 border border-surface-200 dark:border-surface-700">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-1 min-w-64">
                            <p-inputgroup>
                                <p-inputgroup-addon>
                                    <i class="pi pi-search"></i>
                                </p-inputgroup-addon>
                                <input pInputText [(ngModel)]="searchQuery" [placeholder]="'HRM.DOCUMENTS.SEARCH_PLACEHOLDER' | translate" class="w-full" />
                            </p-inputgroup>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <p-select
                                [options]="documentTypes"
                                [(ngModel)]="selectedType"
                                optionLabel="label"
                                optionValue="value"
                                [placeholder]="'HRM.DOCUMENTS.TYPE' | translate"
                                [showClear]="true"
                                class="w-40">
                            </p-select>
                            <p-select
                                [options]="documentCategories"
                                [(ngModel)]="selectedCategory"
                                optionLabel="label"
                                optionValue="value"
                                [placeholder]="'HRM.DOCUMENTS.CATEGORY' | translate"
                                [showClear]="true"
                                class="w-44">
                            </p-select>
                            <p-select
                                [options]="documentStatuses"
                                [(ngModel)]="selectedStatus"
                                optionLabel="label"
                                optionValue="value"
                                [placeholder]="'HRM.DOCUMENTS.STATUS' | translate"
                                [showClear]="true"
                                class="w-40">
                            </p-select>
                            <p-select
                                [options]="departments"
                                [(ngModel)]="selectedDepartment"
                                optionLabel="name"
                                optionValue="id"
                                [placeholder]="'HRM.DOCUMENTS.DEPARTMENT' | translate"
                                [showClear]="true"
                                class="w-44">
                            </p-select>
                            <button pButton icon="pi pi-filter-slash" class="p-button-outlined" [pTooltip]="'HRM.DOCUMENTS.CLEAR_FILTERS' | translate" (click)="clearFilters()"></button>
                        </div>
                    </div>
                </div>

                <!-- Documents Table -->
                <p-table
                    [value]="filteredDocuments"
                    [loading]="loading"
                    [paginator]="true"
                    [rows]="10"
                    [rowsPerPageOptions]="[10, 25, 50]"
                    [showCurrentPageReport]="true"
                    currentPageReportTemplate="Показано {first} - {last} из {totalRecords}"
                    styleClass="p-datatable-sm">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width: 120px">{{ 'HRM.DOCUMENTS.NUMBER' | translate }}</th>
                            <th>{{ 'HRM.DOCUMENTS.TITLE_LABEL' | translate }}</th>
                            <th style="width: 140px">{{ 'HRM.DOCUMENTS.TYPE' | translate }}</th>
                            <th style="width: 120px">{{ 'HRM.DOCUMENTS.CATEGORY' | translate }}</th>
                            <th style="width: 180px">{{ 'HRM.DOCUMENTS.EMPLOYEE' | translate }}</th>
                            <th style="width: 120px">{{ 'HRM.DOCUMENTS.STATUS' | translate }}</th>
                            <th style="width: 100px">{{ 'HRM.DOCUMENTS.DATE' | translate }}</th>
                            <th style="width: 140px">{{ 'HRM.DOCUMENTS.ACTIONS' | translate }}</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-doc>
                        <tr>
                            <td>
                                <span class="font-mono text-sm">{{ doc.document_number }}</span>
                            </td>
                            <td>
                                <div class="flex items-center gap-2">
                                    <i class="pi {{ getTypeIcon(doc.type) }} text-surface-500"></i>
                                    <span class="font-medium">{{ doc.title }}</span>
                                </div>
                            </td>
                            <td>{{ getTypeLabel(doc.type) }}</td>
                            <td>{{ getCategoryLabel(doc.category) }}</td>
                            <td>
                                <span *ngIf="doc.employee_name">{{ doc.employee_name }}</span>
                                <span *ngIf="!doc.employee_name" class="text-surface-400">—</span>
                            </td>
                            <td>
                                <p-tag [value]="getStatusLabel(doc.status)" [severity]="getStatusSeverity(doc.status)"></p-tag>
                            </td>
                            <td>{{ formatDate(doc.created_at) }}</td>
                            <td>
                                <div class="flex gap-1">
                                    <button pButton icon="pi pi-eye" class="p-button-text p-button-sm" [pTooltip]="'HRM.DOCUMENTS.VIEW' | translate" (click)="viewDocumentDetails(doc)"></button>
                                    <button *ngIf="canEdit(doc)" pButton icon="pi pi-pencil" class="p-button-text p-button-sm" [pTooltip]="'HRM.DOCUMENTS.EDIT' | translate" (click)="openEditDocumentDialog(doc)"></button>
                                    <button *ngIf="canSendForSignature(doc)" pButton icon="pi pi-send" class="p-button-text p-button-sm p-button-info" [pTooltip]="'HRM.DOCUMENTS.SEND_FOR_SIGNATURE' | translate" (click)="sendForSignature(doc)"></button>
                                    <button *ngIf="canSign(doc)" pButton icon="pi pi-check" class="p-button-text p-button-sm p-button-success" [pTooltip]="'HRM.DOCUMENTS.SIGN' | translate" (click)="openSignDialog(doc)"></button>
                                    <button *ngIf="canEdit(doc)" pButton icon="pi pi-trash" class="p-button-text p-button-sm p-button-danger" [pTooltip]="'HRM.DOCUMENTS.DELETE' | translate" (click)="deleteDocument(doc)"></button>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="8" class="text-center p-8">
                                <i class="pi pi-folder-open text-4xl text-surface-300 mb-2"></i>
                                <p class="text-surface-500 m-0">{{ 'HRM.DOCUMENTS.NO_DOCUMENTS' | translate }}</p>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-tabpanel>

            <!-- Requests Tab -->
            <p-tabpanel [value]="1">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-surface-900 dark:text-surface-0 m-0">{{ 'HRM.DOCUMENTS.DOCUMENT_REQUESTS_TITLE' | translate }}</h3>
                    <button pButton [label]="'HRM.DOCUMENTS.NEW_REQUEST' | translate" icon="pi pi-plus" class="p-button-outlined" (click)="openNewRequestDialog()"></button>
                </div>

                <p-table
                    [value]="requests"
                    [paginator]="true"
                    [rows]="10"
                    styleClass="p-datatable-sm">
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width: 80px">{{ 'HRM.DOCUMENTS.ID' | translate }}</th>
                            <th>{{ 'HRM.DOCUMENTS.DOCUMENT_TYPE' | translate }}</th>
                            <th>{{ 'HRM.DOCUMENTS.EMPLOYEE' | translate }}</th>
                            <th>{{ 'HRM.DOCUMENTS.DEPARTMENT' | translate }}</th>
                            <th>{{ 'HRM.DOCUMENTS.PURPOSE' | translate }}</th>
                            <th style="width: 80px">{{ 'HRM.DOCUMENTS.COPIES' | translate }}</th>
                            <th style="width: 120px">{{ 'HRM.DOCUMENTS.STATUS' | translate }}</th>
                            <th style="width: 120px">{{ 'HRM.DOCUMENTS.REQUEST_DATE' | translate }}</th>
                            <th style="width: 140px">{{ 'HRM.DOCUMENTS.ACTIONS' | translate }}</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-request>
                        <tr>
                            <td>#{{ request.id }}</td>
                            <td>{{ getTypeLabel(request.document_type) }}</td>
                            <td>{{ request.employee_name }}</td>
                            <td>{{ request.department_name }}</td>
                            <td>{{ request.purpose || '—' }}</td>
                            <td class="text-center">{{ request.copies_count }}</td>
                            <td>
                                <p-tag [value]="getRequestStatusLabel(request.status)" [severity]="getRequestStatusSeverity(request.status)"></p-tag>
                            </td>
                            <td>{{ formatDate(request.requested_at) }}</td>
                            <td>
                                <div class="flex gap-1">
                                    <ng-container *ngIf="request.status === 'pending'">
                                        <button pButton icon="pi pi-check" class="p-button-text p-button-sm p-button-success" [pTooltip]="'HRM.DOCUMENTS.ACCEPT' | translate" (click)="processRequest(request, true)"></button>
                                        <button pButton icon="pi pi-times" class="p-button-text p-button-sm p-button-danger" [pTooltip]="'HRM.DOCUMENTS.REJECT' | translate" (click)="processRequest(request, false)"></button>
                                    </ng-container>
                                    <ng-container *ngIf="request.status === 'in_progress'">
                                        <button pButton icon="pi pi-check-circle" class="p-button-text p-button-sm p-button-success" [pTooltip]="'HRM.DOCUMENTS.COMPLETE' | translate" (click)="completeRequest(request)"></button>
                                    </ng-container>
                                    <ng-container *ngIf="request.status === 'completed' && request.document_id">
                                        <button pButton icon="pi pi-file" class="p-button-text p-button-sm" [pTooltip]="'HRM.DOCUMENTS.OPEN_DOCUMENT' | translate"></button>
                                    </ng-container>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="9" class="text-center p-8">
                                <i class="pi pi-inbox text-4xl text-surface-300 mb-2"></i>
                                <p class="text-surface-500 m-0">{{ 'HRM.DOCUMENTS.NO_REQUESTS' | translate }}</p>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-tabpanel>
        </p-tabpanels>
    </p-tabs>
</div>

<!-- Document Dialog -->
<p-dialog
    [header]="isEditMode ? ('HRM.DOCUMENTS.EDIT_DOCUMENT' | translate) : ('HRM.DOCUMENTS.NEW_DOCUMENT' | translate)"
    [(visible)]="displayDocumentDialog"
    [modal]="true"
    [style]="{ width: '600px' }"
    [draggable]="false"
    [resizable]="false">
    <div class="flex flex-col gap-4">
        <div class="grid grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
                <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.DOCUMENT_TYPE_LABEL' | translate }}</label>
                <p-select
                    [options]="documentTypes"
                    [(ngModel)]="documentForm.type"
                    optionLabel="label"
                    optionValue="value"
                    [placeholder]="'HRM.DOCUMENTS.SELECT_TYPE' | translate"
                    class="w-full">
                </p-select>
            </div>
            <div class="flex flex-col gap-2">
                <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.CATEGORY_LABEL' | translate }}</label>
                <p-select
                    [options]="documentCategories"
                    [(ngModel)]="documentForm.category"
                    optionLabel="label"
                    optionValue="value"
                    [placeholder]="'HRM.DOCUMENTS.SELECT_CATEGORY' | translate"
                    class="w-full">
                </p-select>
            </div>
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.TITLE_INPUT' | translate }}</label>
            <input pInputText [(ngModel)]="documentForm.title" [placeholder]="'HRM.DOCUMENTS.ENTER_DOCUMENT_TITLE' | translate" class="w-full" />
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.EMPLOYEE_LABEL' | translate }}</label>
            <p-select
                [options]="employees"
                [(ngModel)]="documentForm.employee_id"
                optionLabel="name"
                optionValue="id"
                [placeholder]="'HRM.DOCUMENTS.SELECT_EMPLOYEE' | translate"
                [showClear]="true"
                [filter]="true"
                [filterPlaceholder]="'HRM.DOCUMENTS.SEARCH_DOTS' | translate"
                class="w-full">
            </p-select>
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.DEPARTMENT_LABEL' | translate }}</label>
            <p-select
                [options]="departments"
                [(ngModel)]="documentForm.department_id"
                optionLabel="name"
                optionValue="id"
                [placeholder]="'HRM.DOCUMENTS.SELECT_DEPARTMENT' | translate"
                [showClear]="true"
                class="w-full">
            </p-select>
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.DESCRIPTION' | translate }}</label>
            <textarea pTextarea [(ngModel)]="documentForm.description" rows="3" [placeholder]="'HRM.DOCUMENTS.DESCRIPTION_PLACEHOLDER' | translate" class="w-full"></textarea>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
                <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.VALID_FROM' | translate }}</label>
                <input pInputText type="date" [(ngModel)]="documentForm.valid_from" class="w-full" />
            </div>
            <div class="flex flex-col gap-2">
                <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.VALID_UNTIL' | translate }}</label>
                <input pInputText type="date" [(ngModel)]="documentForm.valid_until" class="w-full" />
            </div>
        </div>

        <div class="flex items-center gap-2">
            <input type="checkbox" [(ngModel)]="documentForm.requires_signature" id="requiresSignature" />
            <label for="requiresSignature" class="text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.REQUIRES_SIGNATURE' | translate }}</label>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <button pButton [label]="'HRM.DOCUMENTS.CANCEL' | translate" class="p-button-text" (click)="displayDocumentDialog = false"></button>
        <button pButton [label]="'HRM.DOCUMENTS.SAVE' | translate" icon="pi pi-check" (click)="saveDocument()"></button>
    </ng-template>
</p-dialog>

<!-- View Document Dialog -->
<p-dialog
    [header]="'HRM.DOCUMENTS.VIEW_DOCUMENT' | translate"
    [(visible)]="displayViewDialog"
    [modal]="true"
    [style]="{ width: '700px' }"
    [draggable]="false"
    [resizable]="false">
    <div *ngIf="viewDocument" class="flex flex-col gap-4">
        <div class="bg-surface-100 dark:bg-surface-700 rounded-lg p-4">
            <div class="flex items-start justify-between">
                <div>
                    <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ viewDocument.document_number }}</p>
                    <h3 class="text-xl font-semibold text-surface-900 dark:text-surface-0 mt-1 mb-0">{{ viewDocument.title }}</h3>
                </div>
                <p-tag [value]="getStatusLabel(viewDocument.status)" [severity]="getStatusSeverity(viewDocument.status)"></p-tag>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.TYPE' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ getTypeLabel(viewDocument.type) }}</p>
            </div>
            <div>
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.CATEGORY' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ getCategoryLabel(viewDocument.category) }}</p>
            </div>
            <div *ngIf="viewDocument.employee_name">
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.EMPLOYEE' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ viewDocument.employee_name }}</p>
            </div>
            <div *ngIf="viewDocument.department_name">
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.DEPARTMENT' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ viewDocument.department_name }}</p>
            </div>
            <div>
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.CREATED' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ formatDateTime(viewDocument.created_at) }}</p>
            </div>
            <div>
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.AUTHOR' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ viewDocument.created_by_name }}</p>
            </div>
            <div *ngIf="viewDocument.valid_from">
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.VALID_FROM' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ formatDate(viewDocument.valid_from) }}</p>
            </div>
            <div *ngIf="viewDocument.valid_until">
                <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.VALID_UNTIL' | translate }}</p>
                <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ formatDate(viewDocument.valid_until) }}</p>
            </div>
        </div>

        <div *ngIf="viewDocument.description">
            <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ 'HRM.DOCUMENTS.DESCRIPTION' | translate }}</p>
            <p class="text-surface-900 dark:text-surface-0 m-0">{{ viewDocument.description }}</p>
        </div>

        <!-- Signatures -->
        <div *ngIf="viewDocument.signatures && viewDocument.signatures.length > 0">
            <p class="text-sm text-surface-500 dark:text-surface-400 mb-2">{{ 'HRM.DOCUMENTS.SIGNATURES' | translate }}</p>
            <div class="border border-surface-200 dark:border-surface-700 rounded-lg overflow-hidden">
                <table class="w-full">
                    <thead class="bg-surface-50 dark:bg-surface-800">
                        <tr>
                            <th class="text-left p-3 text-sm font-medium text-surface-600 dark:text-surface-400">{{ 'HRM.DOCUMENTS.SIGNER' | translate }}</th>
                            <th class="text-left p-3 text-sm font-medium text-surface-600 dark:text-surface-400">{{ 'HRM.DOCUMENTS.POSITION' | translate }}</th>
                            <th class="text-left p-3 text-sm font-medium text-surface-600 dark:text-surface-400">{{ 'HRM.DOCUMENTS.STATUS' | translate }}</th>
                            <th class="text-left p-3 text-sm font-medium text-surface-600 dark:text-surface-400">{{ 'HRM.DOCUMENTS.DATE' | translate }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let sig of viewDocument.signatures" class="border-t border-surface-200 dark:border-surface-700">
                            <td class="p-3 text-surface-900 dark:text-surface-0">{{ sig.signer_name }}</td>
                            <td class="p-3 text-surface-600 dark:text-surface-400">{{ sig.signer_position }}</td>
                            <td class="p-3">
                                <span class="inline-flex items-center gap-1">
                                    <i class="pi" [ngClass]="{
                                        'pi-check-circle text-green-500': sig.status === 'signed',
                                        'pi-clock text-orange-500': sig.status === 'pending',
                                        'pi-times-circle text-red-500': sig.status === 'rejected'
                                    }"></i>
                                    <span [ngClass]="{
                                        'text-green-600 dark:text-green-400': sig.status === 'signed',
                                        'text-orange-600 dark:text-orange-400': sig.status === 'pending',
                                        'text-red-600 dark:text-red-400': sig.status === 'rejected'
                                    }">
                                        {{ sig.status === 'signed' ? ('HRM.DOCUMENTS.SIGNED' | translate) : sig.status === 'pending' ? ('HRM.DOCUMENTS.PENDING' | translate) : ('HRM.DOCUMENTS.REJECTED' | translate) }}
                                    </span>
                                </span>
                            </td>
                            <td class="p-3 text-surface-600 dark:text-surface-400">
                                {{ sig.signed_at ? formatDateTime(sig.signed_at) : '—' }}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tags -->
        <div *ngIf="viewDocument.tags && viewDocument.tags.length > 0">
            <p class="text-sm text-surface-500 dark:text-surface-400 mb-2">{{ 'HRM.DOCUMENTS.TAGS' | translate }}</p>
            <div class="flex flex-wrap gap-2">
                <p-tag *ngFor="let tag of viewDocument.tags" [value]="tag" severity="info"></p-tag>
            </div>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <button pButton [label]="'HRM.DOCUMENTS.CLOSE' | translate" class="p-button-text" (click)="displayViewDialog = false"></button>
        <button *ngIf="viewDocument && canSign(viewDocument)" pButton [label]="'HRM.DOCUMENTS.SIGN' | translate" icon="pi pi-check" class="p-button-success" (click)="displayViewDialog = false; openSignDialog(viewDocument)"></button>
    </ng-template>
</p-dialog>

<!-- Sign Dialog -->
<p-dialog
    [header]="'HRM.DOCUMENTS.SIGN_DOCUMENT' | translate"
    [(visible)]="displaySignDialog"
    [modal]="true"
    [style]="{ width: '450px' }"
    [draggable]="false"
    [resizable]="false">
    <div class="flex flex-col gap-4" *ngIf="selectedDocument">
        <div class="bg-surface-100 dark:bg-surface-700 rounded-lg p-3">
            <p class="font-medium text-surface-900 dark:text-surface-0 m-0">{{ selectedDocument.title }}</p>
            <p class="text-sm text-surface-500 dark:text-surface-400 m-0">{{ selectedDocument.document_number }}</p>
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.COMMENT_OPTIONAL' | translate }}</label>
            <textarea pTextarea [(ngModel)]="signComment" rows="3" [placeholder]="'HRM.DOCUMENTS.ENTER_COMMENT' | translate" class="w-full"></textarea>
        </div>

        <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg p-3">
            <div class="flex items-start gap-2">
                <i class="pi pi-info-circle text-blue-500 mt-0.5"></i>
                <p class="text-sm text-blue-700 dark:text-blue-300 m-0">
                    {{ 'HRM.DOCUMENTS.SIGN_NOTICE' | translate }}
                </p>
            </div>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <button pButton [label]="'HRM.DOCUMENTS.REJECT' | translate" icon="pi pi-times" class="p-button-danger p-button-outlined" (click)="signDocument(false)"></button>
        <button pButton [label]="'HRM.DOCUMENTS.SIGN' | translate" icon="pi pi-check" class="p-button-success" (click)="signDocument(true)"></button>
    </ng-template>
</p-dialog>

<!-- Request Dialog -->
<p-dialog
    [header]="'HRM.DOCUMENTS.DOCUMENT_REQUEST' | translate"
    [(visible)]="displayRequestDialog"
    [modal]="true"
    [style]="{ width: '450px' }"
    [draggable]="false"
    [resizable]="false">
    <div class="flex flex-col gap-4">
        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.DOCUMENT_TYPE_LABEL' | translate }}</label>
            <p-select
                [options]="documentTypes"
                [(ngModel)]="requestForm.document_type"
                optionLabel="label"
                optionValue="value"
                [placeholder]="'HRM.DOCUMENTS.SELECT_TYPE' | translate"
                class="w-full">
            </p-select>
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.PURPOSE_LABEL' | translate }}</label>
            <input pInputText [(ngModel)]="requestForm.purpose" [placeholder]="'HRM.DOCUMENTS.PURPOSE_PLACEHOLDER' | translate" class="w-full" />
        </div>

        <div class="flex flex-col gap-2">
            <label class="font-medium text-surface-700 dark:text-surface-300">{{ 'HRM.DOCUMENTS.COPIES_COUNT' | translate }}</label>
            <input pInputText type="number" [(ngModel)]="requestForm.copies_count" min="1" max="10" class="w-full" />
        </div>
    </div>

    <ng-template pTemplate="footer">
        <button pButton [label]="'HRM.DOCUMENTS.CANCEL' | translate" class="p-button-text" (click)="displayRequestDialog = false"></button>
        <button pButton [label]="'HRM.DOCUMENTS.SEND_REQUEST' | translate" icon="pi pi-send" (click)="displayRequestDialog = false"></button>
    </ng-template>
</p-dialog>

<!-- Confirm Dialog -->
<p-confirmdialog></p-confirmdialog>
