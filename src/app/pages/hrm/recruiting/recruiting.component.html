<div class="card">
    <div class="font-semibold text-xl mb-4">{{ 'HRM.RECRUITING.TITLE' | translate }}</div>

    <!-- Статистика -->
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
        <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 text-center">
            <div class="text-3xl font-bold text-blue-600">{{ openVacanciesCount }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">{{ 'HRM.RECRUITING.OPEN_VACANCIES' | translate }}</div>
        </div>
        <div class="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 text-center">
            <div class="text-3xl font-bold text-yellow-600">{{ pendingApprovalCount }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">{{ 'HRM.RECRUITING.PENDING_APPROVAL' | translate }}</div>
        </div>
        <div class="bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 text-center">
            <div class="text-3xl font-bold text-purple-600">{{ newCandidatesCount }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">{{ 'HRM.RECRUITING.NEW_APPLICATIONS' | translate }}</div>
        </div>
        <div class="bg-cyan-50 dark:bg-cyan-900/20 rounded-lg p-4 text-center">
            <div class="text-3xl font-bold text-cyan-600">{{ interviewingCount }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">{{ 'HRM.RECRUITING.INTERVIEWING' | translate }}</div>
        </div>
        <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4 text-center">
            <div class="text-3xl font-bold text-green-600">{{ offersCount }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">{{ 'HRM.RECRUITING.OFFERS' | translate }}</div>
        </div>
        <div class="bg-teal-50 dark:bg-teal-900/20 rounded-lg p-4 text-center">
            <div class="text-3xl font-bold text-teal-600">{{ activeOnboardingsCount }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">{{ 'HRM.RECRUITING.ONBOARDING' | translate }}</div>
        </div>
    </div>

    <p-tabs [(value)]="activeTab">
        <p-tablist>
            <p-tab [value]="0">{{ 'HRM.RECRUITING.VACANCIES_TAB' | translate }}</p-tab>
            <p-tab [value]="1">{{ 'HRM.RECRUITING.CANDIDATES_TAB' | translate }}</p-tab>
            <p-tab [value]="2">{{ 'HRM.RECRUITING.ONBOARDING_TAB' | translate }}</p-tab>
        </p-tablist>

        <p-tabpanels>
            <!-- Вкладка Вакансии -->
            <p-tabpanel [value]="0">
                <p-table
                    #dtVacancies
                    [value]="vacancies"
                    dataKey="id"
                    [rows]="10"
                    [loading]="loading"
                    [rowHover]="true"
                    [showGridlines]="true"
                    [paginator]="true"
                    [globalFilterFields]="['title', 'department_name', 'position_name']"
                >
                    <ng-template #caption>
                        <div class="flex justify-between items-center flex-column sm:flex-row">
                            <p-iconfield>
                                <p-inputicon>
                                    <i class="pi pi-search"></i>
                                </p-inputicon>
                                <input pInputText type="text" (input)="onGlobalFilter(dtVacancies, $event)" [placeholder]="'HRM.RECRUITING.SEARCH' | translate" />
                            </p-iconfield>
                            <button pButton (click)="openVacancyDialog()">
                                <i class="pi pi-plus"></i>
                                <span>{{ 'HRM.RECRUITING.CREATE_REQUEST' | translate }}</span>
                            </button>
                        </div>
                    </ng-template>
                    <ng-template #header>
                        <tr>
                            <th pSortableColumn="title" style="min-width: 14rem">{{ 'HRM.RECRUITING.TITLE_COLUMN' | translate }}</th>
                            <th style="min-width: 10rem">{{ 'HRM.RECRUITING.DEPARTMENT' | translate }}</th>
                            <th style="min-width: 10rem">{{ 'HRM.RECRUITING.POSITION' | translate }}</th>
                            <th style="min-width: 10rem">{{ 'HRM.RECRUITING.SALARY' | translate }}</th>
                            <th style="min-width: 5rem">{{ 'HRM.RECRUITING.RESPONSES' | translate }}</th>
                            <th style="min-width: 6rem">{{ 'HRM.RECRUITING.PRIORITY' | translate }}</th>
                            <th style="min-width: 8rem">{{ 'HRM.RECRUITING.STATUS' | translate }}</th>
                            <th style="width: 12rem">{{ 'HRM.RECRUITING.ACTIONS' | translate }}</th>
                        </tr>
                    </ng-template>
                    <ng-template #body let-vacancy>
                        <tr>
                            <td>
                                <div class="font-medium">{{ vacancy.title }}</div>
                                @if (vacancy.requested_by_name) {
                                    <div class="text-xs text-gray-500">{{ 'HRM.RECRUITING.APPLICANT' | translate }}: {{ vacancy.requested_by_name }}</div>
                                }
                            </td>
                            <td>{{ vacancy.department_name || '—' }}</td>
                            <td>{{ vacancy.position_name || '—' }}</td>
                            <td>
                                @if (vacancy.salary_from || vacancy.salary_to) {
                                    {{ vacancy.salary_from | number:'1.0-0' }} - {{ vacancy.salary_to | number:'1.0-0' }}
                                } @else {
                                    {{ 'HRM.RECRUITING.BY_AGREEMENT' | translate }}
                                }
                            </td>
                            <td class="text-center">{{ vacancy.applications_count || 0 }}</td>
                            <td>
                                @if (vacancy.priority === 'high') {
                                    <p-tag [value]="'HRM.RECRUITING.HIGH' | translate" severity="danger"></p-tag>
                                } @else if (vacancy.priority === 'urgent') {
                                    <p-tag [value]="'HRM.RECRUITING.URGENT' | translate" severity="danger"></p-tag>
                                } @else {
                                    <p-tag [value]="'HRM.RECRUITING.NORMAL' | translate" severity="secondary"></p-tag>
                                }
                            </td>
                            <td>
                                <p-tag [value]="getStatusLabel(vacancy.status, 'vacancy')" [severity]="getVacancyStatusSeverity(vacancy.status)"></p-tag>
                            </td>
                            <td>
                                <div class="flex justify-center gap-1">
                                    @if (vacancy.status === 'draft') {
                                        <button pButton
                                                icon="pi pi-send"
                                                (click)="submitForApproval(vacancy)"
                                                class="p-button-rounded p-button-text p-button-info"
                                                [pTooltip]="'HRM.RECRUITING.SEND_FOR_APPROVAL' | translate"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (vacancy.status === 'pending_approval') {
                                        <button pButton
                                                icon="pi pi-check"
                                                (click)="approveVacancy(vacancy)"
                                                class="p-button-rounded p-button-text p-button-success"
                                                [pTooltip]="'HRM.RECRUITING.APPROVE' | translate"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (vacancy.status === 'approved') {
                                        <button pButton
                                                icon="pi pi-globe"
                                                (click)="publishVacancy(vacancy)"
                                                class="p-button-rounded p-button-text p-button-success"
                                                [pTooltip]="'HRM.RECRUITING.PUBLISH' | translate"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (vacancy.status === 'open') {
                                        <button pButton
                                                icon="pi pi-lock"
                                                (click)="closeVacancy(vacancy)"
                                                class="p-button-rounded p-button-text p-button-danger"
                                                [pTooltip]="'HRM.RECRUITING.CLOSE' | translate"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (vacancy.status !== 'closed' && vacancy.status !== 'cancelled') {
                                        <button pButton
                                                icon="pi pi-pencil"
                                                (click)="openEditVacancyDialog(vacancy)"
                                                class="p-button-rounded p-button-text p-button-warning"
                                                [pTooltip]="'HRM.RECRUITING.EDIT' | translate"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template #emptymessage>
                        <tr>
                            <td colspan="8">{{ 'HRM.RECRUITING.NO_VACANCIES' | translate }}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-tabpanel>

            <!-- Вкладка Кандидаты -->
            <p-tabpanel [value]="1">
                <p-table
                    #dtCandidates
                    [value]="candidates"
                    dataKey="id"
                    [rows]="10"
                    [loading]="loading"
                    [rowHover]="true"
                    [showGridlines]="true"
                    [paginator]="true"
                    [globalFilterFields]="['full_name', 'email', 'vacancy_title']"
                >
                    <ng-template #caption>
                        <div class="flex justify-between items-center flex-column sm:flex-row">
                            <p-iconfield>
                                <p-inputicon>
                                    <i class="pi pi-search"></i>
                                </p-inputicon>
                                <input pInputText type="text" (input)="onGlobalFilter(dtCandidates, $event)" [placeholder]="'HRM.RECRUITING.SEARCH' | translate" />
                            </p-iconfield>
                            <button pButton (click)="openCandidateDialog()">
                                <i class="pi pi-user-plus"></i>
                                <span>{{ 'HRM.RECRUITING.ADD_CANDIDATE' | translate }}</span>
                            </button>
                        </div>
                    </ng-template>
                    <ng-template #header>
                        <tr>
                            <th pSortableColumn="full_name" style="min-width: 14rem">{{ 'HRM.RECRUITING.FULL_NAME' | translate }}</th>
                            <th style="min-width: 12rem">{{ 'HRM.RECRUITING.VACANCY' | translate }}</th>
                            <th style="min-width: 8rem">{{ 'HRM.RECRUITING.SOURCE' | translate }}</th>
                            <th style="min-width: 6rem">{{ 'HRM.RECRUITING.STAGE' | translate }}</th>
                            <th style="min-width: 8rem">{{ 'HRM.RECRUITING.STATUS' | translate }}</th>
                            <th style="width: 6rem">{{ 'HRM.RECRUITING.RATING' | translate }}</th>
                            <th style="width: 14rem">{{ 'HRM.RECRUITING.ACTIONS' | translate }}</th>
                        </tr>
                    </ng-template>
                    <ng-template #body let-candidate>
                        <tr>
                            <td>
                                <div class="font-medium">{{ candidate.full_name }}</div>
                                <div class="text-xs text-gray-500">{{ candidate.email }}</div>
                                <div class="text-xs text-gray-500">{{ candidate.phone }}</div>
                            </td>
                            <td>{{ candidate.vacancy_title || '—' }}</td>
                            <td>
                                @switch (candidate.source) {
                                    @case ('gov_portal') { <span>Госпортал</span> }
                                    @case ('job_portal') { <span>Job-сайт</span> }
                                    @case ('referral') { <span>Рекомендация</span> }
                                    @case ('social_media') { <span>Соцсети</span> }
                                    @case ('direct') { <span>Напрямую</span> }
                                    @default { <span>{{ candidate.source }}</span> }
                                }
                            </td>
                            <td>
                                <p-progressBar
                                    [value]="getStageProgress(candidate.stage)"
                                    [showValue]="false"
                                    [style]="{ height: '6px' }">
                                </p-progressBar>
                                <div class="text-xs mt-1 text-center text-gray-500">
                                    @for (stage of recruitingStages; track stage.value) {
                                        @if (stage.value === candidate.stage) {
                                            {{ stage.label }}
                                        }
                                    }
                                </div>
                            </td>
                            <td>
                                <p-tag [value]="getStatusLabel(candidate.status, 'candidate')" [severity]="getCandidateStatusSeverity(candidate.status)"></p-tag>
                            </td>
                            <td>
                                @if (candidate.rating) {
                                    <div class="flex items-center gap-1">
                                        <i class="pi pi-star-fill text-yellow-500"></i>
                                        <span>{{ candidate.rating }}/5</span>
                                    </div>
                                } @else {
                                    <span class="text-gray-400">—</span>
                                }
                            </td>
                            <td>
                                <div class="flex justify-center gap-1 flex-wrap">
                                    <button pButton
                                            icon="pi pi-eye"
                                            (click)="openCandidateDetail(candidate)"
                                            class="p-button-rounded p-button-text p-button-info"
                                            [pTooltip]="'COMMON.ACTIONS' | translate"
                                            tooltipPosition="top">
                                    </button>
                                    @if (candidate.status === 'new') {
                                        <button pButton
                                                icon="pi pi-check"
                                                (click)="screenCandidate(candidate, true)"
                                                class="p-button-rounded p-button-text p-button-success"
                                                pTooltip="Пройти скрининг"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (candidate.status === 'screening' || candidate.status === 'phone_interview' || candidate.status === 'interview') {
                                        <button pButton
                                                icon="pi pi-calendar"
                                                (click)="openInterviewDialog(candidate)"
                                                class="p-button-rounded p-button-text p-button-info"
                                                pTooltip="Назначить собеседование"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (candidate.status === 'interview' || candidate.status === 'reference_check') {
                                        <button pButton
                                                icon="pi pi-verified"
                                                (click)="openReferenceDialog(candidate)"
                                                class="p-button-rounded p-button-text p-button-warning"
                                                pTooltip="Проверка рекомендаций"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (candidate.status === 'reference_check' || candidate.status === 'interview') {
                                        <button pButton
                                                icon="pi pi-file-edit"
                                                (click)="openOfferDialog(candidate)"
                                                class="p-button-rounded p-button-text p-button-success"
                                                pTooltip="Отправить оффер"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (candidate.status === 'offer') {
                                        <button pButton
                                                icon="pi pi-thumbs-up"
                                                (click)="acceptOffer(candidate)"
                                                class="p-button-rounded p-button-text p-button-success"
                                                pTooltip="Оффер принят"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (candidate.status === 'offer_accepted') {
                                        <button pButton
                                                icon="pi pi-user-plus"
                                                (click)="hireCandidate(candidate)"
                                                class="p-button-rounded p-button-text p-button-success"
                                                pTooltip="Оформить на работу"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    @if (candidate.status !== 'hired' && candidate.status !== 'rejected' && candidate.status !== 'withdrawn') {
                                        <button pButton
                                                icon="pi pi-times"
                                                (click)="openRejectDialog(candidate)"
                                                class="p-button-rounded p-button-text p-button-danger"
                                                pTooltip="Отклонить"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template #emptymessage>
                        <tr>
                            <td colspan="7">{{ 'HRM.RECRUITING.NO_CANDIDATES' | translate }}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-tabpanel>

            <!-- Вкладка Адаптация -->
            <p-tabpanel [value]="2">
                <p-table
                    #dtOnboardings
                    [value]="onboardings"
                    dataKey="id"
                    [rows]="10"
                    [loading]="loading"
                    [rowHover]="true"
                    [showGridlines]="true"
                    [paginator]="true"
                    [globalFilterFields]="['employee_name']"
                >
                    <ng-template #caption>
                        <div class="flex justify-between items-center">
                            <p-iconfield>
                                <p-inputicon>
                                    <i class="pi pi-search"></i>
                                </p-inputicon>
                                <input pInputText type="text" (input)="onGlobalFilter(dtOnboardings, $event)" [placeholder]="'HRM.RECRUITING.SEARCH' | translate" />
                            </p-iconfield>
                        </div>
                    </ng-template>
                    <ng-template #header>
                        <tr>
                            <th style="min-width: 14rem">{{ 'HRM.RECRUITING.EMPLOYEE' | translate }}</th>
                            <th style="min-width: 10rem">{{ 'HRM.RECRUITING.START_DATE' | translate }}</th>
                            <th style="min-width: 10rem">{{ 'HRM.RECRUITING.MENTOR' | translate }}</th>
                            <th style="min-width: 10rem">{{ 'HRM.RECRUITING.PROGRESS' | translate }}</th>
                            <th style="min-width: 8rem">{{ 'HRM.RECRUITING.STATUS' | translate }}</th>
                            <th style="width: 10rem">{{ 'HRM.RECRUITING.ACTIONS' | translate }}</th>
                        </tr>
                    </ng-template>
                    <ng-template #body let-onboarding>
                        <tr>
                            <td>
                                <div class="font-medium">{{ onboarding.employee_name }}</div>
                                <div class="text-xs text-gray-500">ID: {{ onboarding.employee_id }}</div>
                            </td>
                            <td>{{ onboarding.start_date | date:'dd.MM.yyyy' }}</td>
                            <td>
                                @if (onboarding.mentor_name) {
                                    {{ onboarding.mentor_name }}
                                } @else {
                                    <span class="text-yellow-500">{{ 'HRM.RECRUITING.NOT_ASSIGNED' | translate }}</span>
                                }
                            </td>
                            <td>
                                <p-progressBar [value]="onboarding.overall_progress" [showValue]="true"></p-progressBar>
                            </td>
                            <td>
                                <p-tag [value]="onboarding.status === 'in_progress' ? ('HRM.RECRUITING.ONBOARDING.STATUS_IN_PROGRESS' | translate) : onboarding.status === 'completed' ? ('HRM.RECRUITING.ONBOARDING.STATUS_COMPLETED' | translate) : ('HRM.RECRUITING.ONBOARDING.STATUS_NOT_STARTED' | translate)"
                                       [severity]="getOnboardingStatusSeverity(onboarding.status)"></p-tag>
                            </td>
                            <td>
                                <div class="flex justify-center gap-1">
                                    @if (!onboarding.mentor_id) {
                                        <button pButton
                                                icon="pi pi-user"
                                                (click)="assignMentor(onboarding)"
                                                class="p-button-rounded p-button-text p-button-info"
                                                [pTooltip]="'HRM.RECRUITING.ONBOARDING.ASSIGN_MENTOR' | translate"
                                                tooltipPosition="top">
                                        </button>
                                    }
                                    <button pButton
                                            icon="pi pi-list-check"
                                            (click)="selectedOnboarding = onboarding; displayOnboardingDialog = true"
                                            class="p-button-rounded p-button-text p-button-success"
                                            [pTooltip]="'HRM.RECRUITING.ONBOARDING.TASKS' | translate"
                                            tooltipPosition="top">
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template #emptymessage>
                        <tr>
                            <td colspan="6">{{ 'HRM.RECRUITING.ONBOARDING.NO_RECORDS' | translate }}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-tabpanel>
        </p-tabpanels>
    </p-tabs>
</div>

<!-- Диалог создания/редактирования вакансии -->
<p-dialog
    [(visible)]="displayVacancyDialog"
    [header]="isEditMode ? ('HRM.RECRUITING.VACANCY.EDIT_VACANCY' | translate) : ('HRM.RECRUITING.VACANCY.CREATE_REQUEST' | translate)"
    [modal]="true"
    [style]="{ width: '700px' }"
    [closable]="true">
    <form [formGroup]="vacancyForm" class="p-4">
        <div class="grid grid-cols-1 gap-4">
            <div class="field">
                <label for="title" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.TITLE_LABEL' | translate }} *</label>
                <input pInputText id="title" formControlName="title" class="w-full" />
                @if (submitted && vacancyForm.get('title')?.errors?.['required']) {
                    <small class="text-red-500">{{ 'HRM.RECRUITING.VACANCY.TITLE_REQUIRED' | translate }}</small>
                }
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="field">
                    <label for="department" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.DEPARTMENT' | translate }} *</label>
                    <p-select
                        id="department"
                        formControlName="department_id"
                        [options]="departments"
                        optionLabel="name"
                        [placeholder]="'HRM.RECRUITING.VACANCY.SELECT_DEPARTMENT' | translate"
                        class="w-full">
                    </p-select>
                </div>
                <div class="field">
                    <label for="position" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.POSITION' | translate }} *</label>
                    <p-select
                        id="position"
                        formControlName="position_id"
                        [options]="positions"
                        optionLabel="name"
                        [placeholder]="'HRM.RECRUITING.VACANCY.SELECT_POSITION' | translate"
                        class="w-full">
                    </p-select>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="field">
                    <label for="employment_type" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.EMPLOYMENT_TYPE' | translate }} *</label>
                    <p-select
                        id="employment_type"
                        formControlName="employment_type"
                        [options]="employmentTypes"
                        optionLabel="label"
                        [placeholder]="'HRM.RECRUITING.VACANCY.SELECT_TYPE' | translate"
                        class="w-full">
                    </p-select>
                </div>
                <div class="field">
                    <label for="priority" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.PRIORITY' | translate }}</label>
                    <p-select
                        id="priority"
                        formControlName="priority"
                        [options]="vacancyPriorities"
                        optionLabel="label"
                        [placeholder]="'HRM.RECRUITING.VACANCY.PRIORITY_NORMAL' | translate"
                        class="w-full">
                    </p-select>
                </div>
            </div>

            <div class="grid grid-cols-3 gap-4">
                <div class="field">
                    <label for="salary_from" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.SALARY_FROM' | translate }}</label>
                    <p-inputNumber id="salary_from" formControlName="salary_from" class="w-full"></p-inputNumber>
                </div>
                <div class="field">
                    <label for="salary_to" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.SALARY_TO' | translate }}</label>
                    <p-inputNumber id="salary_to" formControlName="salary_to" class="w-full"></p-inputNumber>
                </div>
                <div class="field">
                    <label for="experience" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.EXPERIENCE_YEARS' | translate }}</label>
                    <p-inputNumber id="experience" formControlName="experience_years" class="w-full"></p-inputNumber>
                </div>
            </div>

            <div class="field">
                <label for="deadline" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.DEADLINE' | translate }}</label>
                <p-date-picker id="deadline" formControlName="deadline" [showIcon]="true" class="w-full"></p-date-picker>
            </div>

            <div class="field">
                <label for="description" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.DESCRIPTION' | translate }} *</label>
                <textarea pTextarea id="description" formControlName="description" rows="3" class="w-full"></textarea>
            </div>

            <div class="field">
                <label for="requirements" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.REQUIREMENTS' | translate }} *</label>
                <textarea pTextarea id="requirements" formControlName="requirements" rows="3" class="w-full"></textarea>
            </div>

            <div class="field">
                <label for="responsibilities" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.RESPONSIBILITIES' | translate }}</label>
                <textarea pTextarea id="responsibilities" formControlName="responsibilities" rows="3" class="w-full"></textarea>
            </div>

            <div class="field">
                <label for="justification" class="font-medium">{{ 'HRM.RECRUITING.VACANCY.JUSTIFICATION' | translate }}</label>
                <textarea pTextarea id="justification" formControlName="request_justification" rows="2" class="w-full"
                          [placeholder]="'HRM.RECRUITING.VACANCY.JUSTIFICATION_PLACEHOLDER' | translate"></textarea>
            </div>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayVacancyDialog = false"></button>
        <button pButton [label]="isEditMode ? ('COMMON.UPDATE' | translate) : ('COMMON.CREATE' | translate)" icon="pi pi-check" (click)="saveVacancy()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог добавления кандидата -->
<p-dialog
    [(visible)]="displayCandidateDialog"
    [header]="'HRM.RECRUITING.CANDIDATE.ADD_CANDIDATE' | translate"
    [modal]="true"
    [style]="{ width: '500px' }"
    [closable]="true">
    <form [formGroup]="candidateForm" class="p-4">
        <div class="grid grid-cols-1 gap-4">
            <div class="field">
                <label for="vacancy" class="font-medium">{{ 'HRM.RECRUITING.CANDIDATE.VACANCY' | translate }} *</label>
                <p-select
                    id="vacancy"
                    formControlName="vacancy_id"
                    [options]="getVacanciesForSelect()"
                    optionLabel="name"
                    [placeholder]="'HRM.RECRUITING.CANDIDATE.SELECT_VACANCY' | translate"
                    class="w-full">
                </p-select>
            </div>

            <div class="field">
                <label for="full_name" class="font-medium">{{ 'HRM.RECRUITING.CANDIDATE.FULL_NAME' | translate }} *</label>
                <input pInputText id="full_name" formControlName="full_name" class="w-full" />
            </div>

            <div class="field">
                <label for="email" class="font-medium">{{ 'COMMON.EMAIL' | translate }} *</label>
                <input pInputText id="email" formControlName="email" type="email" class="w-full" />
            </div>

            <div class="field">
                <label for="phone" class="font-medium">{{ 'COMMON.PHONE' | translate }} *</label>
                <input pInputText id="phone" formControlName="phone" class="w-full" />
            </div>

            <div class="field">
                <label for="source" class="font-medium">{{ 'HRM.RECRUITING.CANDIDATE.SOURCE' | translate }} *</label>
                <p-select
                    id="source"
                    formControlName="source"
                    [options]="candidateSources"
                    optionLabel="label"
                    [placeholder]="'HRM.RECRUITING.CANDIDATE.SELECT_SOURCE' | translate"
                    class="w-full">
                </p-select>
            </div>

            <div class="field">
                <label for="salary_expectation" class="font-medium">{{ 'HRM.RECRUITING.CANDIDATE.SALARY_EXPECTATION' | translate }}</label>
                <p-inputNumber id="salary_expectation" formControlName="salary_expectation" class="w-full"></p-inputNumber>
            </div>

            <div class="field">
                <label for="available_from" class="font-medium">{{ 'HRM.RECRUITING.CANDIDATE.AVAILABLE_FROM' | translate }}</label>
                <p-date-picker id="available_from" formControlName="available_from" [showIcon]="true" class="w-full"></p-date-picker>
            </div>

            <div class="field">
                <label for="cover_letter" class="font-medium">{{ 'HRM.RECRUITING.CANDIDATE.COVER_LETTER' | translate }}</label>
                <textarea pTextarea id="cover_letter" formControlName="cover_letter" rows="3" class="w-full"></textarea>
            </div>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayCandidateDialog = false"></button>
        <button pButton [label]="'COMMON.ADD' | translate" icon="pi pi-check" (click)="saveCandidate()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог деталей кандидата -->
<p-dialog
    [(visible)]="displayCandidateDetailDialog"
    [header]="selectedCandidate?.full_name || ('HRM.RECRUITING.CANDIDATE.CARD' | translate)"
    [modal]="true"
    [style]="{ width: '800px' }"
    [closable]="true">
    @if (selectedCandidate) {
        <div class="p-4">
            <!-- Основная информация -->
            <div class="grid grid-cols-2 gap-6 mb-6">
                <div>
                    <h4 class="font-semibold mb-3">{{ 'HRM.RECRUITING.CANDIDATE.CONTACT_INFO' | translate }}</h4>
                    <div class="space-y-2">
                        <div><i class="pi pi-envelope mr-2"></i>{{ selectedCandidate.email }}</div>
                        <div><i class="pi pi-phone mr-2"></i>{{ selectedCandidate.phone }}</div>
                        @if (selectedCandidate.salary_expectation) {
                            <div><i class="pi pi-dollar mr-2"></i>{{ 'HRM.RECRUITING.CANDIDATE.EXPECTATIONS' | translate }}: {{ selectedCandidate.salary_expectation | number:'1.0-0' }}</div>
                        }
                    </div>
                </div>
                <div>
                    <h4 class="font-semibold mb-3">{{ 'COMMON.STATUS' | translate }}</h4>
                    <div class="space-y-2">
                        <div>
                            <p-tag [value]="getStatusLabel(selectedCandidate.status, 'candidate')"
                                   [severity]="getCandidateStatusSeverity(selectedCandidate.status)"></p-tag>
                        </div>
                        <div>{{ 'HRM.RECRUITING.CANDIDATE.VACANCY' | translate }}: {{ selectedCandidate.vacancy_title }}</div>
                        @if (selectedCandidate.rating) {
                            <div class="flex items-center gap-1">
                                <span>{{ 'HRM.RECRUITING.CANDIDATE.RATING' | translate }}:</span>
                                <p-rating [(ngModel)]="selectedCandidate.rating" [readonly]="true"></p-rating>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Прогресс -->
            <div class="mb-6">
                <h4 class="font-semibold mb-3">{{ 'HRM.RECRUITING.CANDIDATE.STAGE_PROGRESS' | translate }}</h4>
                <p-progressBar [value]="getStageProgress(selectedCandidate.stage)" [showValue]="true"></p-progressBar>
            </div>

            <!-- История собеседований -->
            @if (selectedCandidate.interviews && selectedCandidate.interviews.length > 0) {
                <div class="mb-6">
                    <h4 class="font-semibold mb-3">{{ 'HRM.RECRUITING.INTERVIEW.INTERVIEWS' | translate }}</h4>
                    <div class="space-y-3">
                        @for (interview of selectedCandidate.interviews; track interview.id) {
                            <div class="border rounded-lg p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <div class="font-medium">
                                            @switch (interview.interview_type) {
                                                @case ('phone') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_PHONE' | translate }} }
                                                @case ('hr') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_HR' | translate }} }
                                                @case ('technical') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_TECHNICAL' | translate }} }
                                                @case ('panel') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_PANEL' | translate }} }
                                                @case ('video') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_VIDEO' | translate }} }
                                                @case ('in_person') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_IN_PERSON' | translate }} }
                                                @case ('final') { {{ 'HRM.RECRUITING.INTERVIEW.TYPE_FINAL' | translate }} }
                                                @default { {{ interview.interview_type }} }
                                            }
                                        </div>
                                        <div class="text-sm text-gray-500">{{ interview.interviewer_name }}</div>
                                        <div class="text-sm text-gray-500">{{ interview.scheduled_at | date:'dd.MM.yyyy HH:mm' }}</div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        @if (interview.status === 'completed') {
                                            <p-tag [value]="'HRM.RECRUITING.INTERVIEW.STATUS_COMPLETED' | translate" severity="success"></p-tag>
                                            @if (interview.overall_rating) {
                                                <span class="flex items-center gap-1">
                                                    <i class="pi pi-star-fill text-yellow-500"></i>
                                                    {{ interview.overall_rating }}/5
                                                </span>
                                            }
                                        } @else if (interview.status === 'scheduled') {
                                            <p-tag [value]="'HRM.RECRUITING.INTERVIEW.STATUS_SCHEDULED' | translate" severity="info"></p-tag>
                                            <button pButton
                                                    icon="pi pi-pencil"
                                                    class="p-button-rounded p-button-text p-button-sm"
                                                    (click)="openFeedbackDialog(selectedCandidate!, interview)"
                                                    [pTooltip]="'HRM.RECRUITING.INTERVIEW.ADD_RESULT' | translate">
                                            </button>
                                        } @else {
                                            <p-tag [value]="interview.status" severity="secondary"></p-tag>
                                        }
                                    </div>
                                </div>
                                @if (interview.feedback) {
                                    <div class="mt-2 text-sm bg-surface-100 dark:bg-surface-700 p-2 rounded">
                                        {{ interview.feedback }}
                                    </div>
                                }
                            </div>
                        }
                    </div>
                </div>
            }

            <!-- Проверка рекомендаций -->
            @if (selectedCandidate.reference_checks && selectedCandidate.reference_checks.length > 0) {
                <div class="mb-6">
                    <h4 class="font-semibold mb-3">{{ 'HRM.RECRUITING.REFERENCE.CHECK_REFERENCES' | translate }}</h4>
                    <div class="space-y-3">
                        @for (ref of selectedCandidate.reference_checks; track ref.id) {
                            <div class="border rounded-lg p-4">
                                <div class="flex justify-between">
                                    <div>
                                        <div class="font-medium">{{ ref.referee_name }}</div>
                                        <div class="text-sm text-gray-500">{{ ref.referee_position }}, {{ ref.referee_company }}</div>
                                    </div>
                                    <div>
                                        @if (ref.status === 'completed') {
                                            <p-tag [value]="'HRM.RECRUITING.REFERENCE.VERIFIED' | translate" severity="success"></p-tag>
                                        } @else {
                                            <p-tag [value]="'HRM.RECRUITING.REFERENCE.PENDING' | translate" severity="warn"></p-tag>
                                            <button pButton
                                                    icon="pi pi-check"
                                                    class="p-button-rounded p-button-text p-button-sm ml-2"
                                                    (click)="completeReferenceCheck(selectedCandidate!, ref)"
                                                    [pTooltip]="'HRM.RECRUITING.REFERENCE.MARK_VERIFIED' | translate">
                                            </button>
                                        }
                                    </div>
                                </div>
                                @if (ref.feedback) {
                                    <div class="mt-2 text-sm">{{ ref.feedback }}</div>
                                }
                            </div>
                        }
                    </div>
                </div>
            }

            <!-- Оффер -->
            @if (selectedCandidate.offer) {
                <div class="mb-6">
                    <h4 class="font-semibold mb-3">{{ 'HRM.RECRUITING.OFFER.JOB_OFFER' | translate }}</h4>
                    <div class="border rounded-lg p-4 bg-green-50 dark:bg-green-900/20">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-sm text-gray-500">{{ 'HRM.RECRUITING.OFFER.OFFERED_SALARY' | translate }}</div>
                                <div class="font-medium">{{ selectedCandidate.offer.offered_salary | number:'1.0-0' }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500">{{ 'HRM.RECRUITING.OFFER.START_DATE' | translate }}</div>
                                <div class="font-medium">{{ selectedCandidate.offer.start_date | date:'dd.MM.yyyy' }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500">{{ 'HRM.RECRUITING.OFFER.PROBATION_PERIOD' | translate }}</div>
                                <div class="font-medium">{{ selectedCandidate.offer.probation_period_months }} {{ 'HRM.RECRUITING.OFFER.MONTHS' | translate }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-500">{{ 'COMMON.STATUS' | translate }}</div>
                                <p-tag [value]="selectedCandidate.offer.status === 'sent' ? ('HRM.RECRUITING.OFFER.STATUS_SENT' | translate) : selectedCandidate.offer.status === 'accepted' ? ('HRM.RECRUITING.OFFER.STATUS_ACCEPTED' | translate) : ('HRM.RECRUITING.OFFER.STATUS_REJECTED' | translate)"
                                       [severity]="selectedCandidate.offer.status === 'accepted' ? 'success' : selectedCandidate.offer.status === 'sent' ? 'info' : 'danger'"></p-tag>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    <ng-template #footer>
        <button pButton [label]="'COMMON.CLOSE' | translate" icon="pi pi-times" class="p-button-text" (click)="displayCandidateDetailDialog = false"></button>
    </ng-template>
</p-dialog>

<!-- Диалог назначения собеседования -->
<p-dialog
    [(visible)]="displayInterviewDialog"
    [header]="'HRM.RECRUITING.INTERVIEW.SCHEDULE_INTERVIEW' | translate"
    [modal]="true"
    [style]="{ width: '500px' }"
    [closable]="true">
    <form [formGroup]="interviewForm" class="p-4">
        <div class="grid grid-cols-1 gap-4">
            <div class="field">
                <label for="interview_type" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.TYPE' | translate }} *</label>
                <p-select
                    id="interview_type"
                    formControlName="interview_type"
                    [options]="interviewTypes"
                    optionLabel="label"
                    [placeholder]="'HRM.RECRUITING.INTERVIEW.SELECT_TYPE' | translate"
                    class="w-full">
                </p-select>
            </div>

            <div class="field">
                <label for="interviewer" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.INTERVIEWER' | translate }} *</label>
                <p-select
                    id="interviewer"
                    formControlName="interviewer_id"
                    [options]="interviewers"
                    optionLabel="name"
                    [placeholder]="'HRM.RECRUITING.INTERVIEW.SELECT_INTERVIEWER' | translate"
                    class="w-full">
                </p-select>
            </div>

            <div class="field">
                <label for="scheduled_at" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.DATE_TIME' | translate }} *</label>
                <p-date-picker
                    id="scheduled_at"
                    formControlName="scheduled_at"
                    [showTime]="true"
                    [showIcon]="true"
                    class="w-full">
                </p-date-picker>
            </div>

            <div class="field">
                <label for="duration" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.DURATION_MIN' | translate }}</label>
                <p-inputNumber id="duration" formControlName="duration_minutes" class="w-full"></p-inputNumber>
            </div>

            <div class="field">
                <label for="location" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.LOCATION' | translate }}</label>
                <input pInputText id="location" formControlName="location" class="w-full" [placeholder]="'HRM.RECRUITING.INTERVIEW.LOCATION_PLACEHOLDER' | translate" />
            </div>

            <div class="field">
                <label for="meeting_link" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.MEETING_LINK' | translate }}</label>
                <input pInputText id="meeting_link" formControlName="meeting_link" class="w-full" />
            </div>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayInterviewDialog = false"></button>
        <button pButton [label]="'HRM.RECRUITING.INTERVIEW.SCHEDULE' | translate" icon="pi pi-calendar" (click)="scheduleInterview()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог результата собеседования -->
<p-dialog
    [(visible)]="displayInterviewFeedbackDialog"
    [header]="'HRM.RECRUITING.INTERVIEW.RESULT' | translate"
    [modal]="true"
    [style]="{ width: '500px' }"
    [closable]="true">
    <form [formGroup]="feedbackForm" class="p-4">
        <div class="grid grid-cols-1 gap-4">
            <div class="field">
                <label class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.OVERALL_RATING' | translate }} *</label>
                <div class="mt-2">
                    <p-rating formControlName="overall_rating"></p-rating>
                </div>
            </div>

            <div class="field">
                <label for="recommendation" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.RECOMMENDATION' | translate }} *</label>
                <p-select
                    id="recommendation"
                    formControlName="recommendation"
                    [options]="interviewRecommendations"
                    optionLabel="label"
                    [placeholder]="'HRM.RECRUITING.INTERVIEW.SELECT_RECOMMENDATION' | translate"
                    class="w-full">
                </p-select>
            </div>

            <div class="field">
                <label for="strengths" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.STRENGTHS' | translate }}</label>
                <input pInputText id="strengths" formControlName="strengths" class="w-full" [placeholder]="'HRM.RECRUITING.INTERVIEW.COMMA_SEPARATED' | translate" />
            </div>

            <div class="field">
                <label for="weaknesses" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.WEAKNESSES' | translate }}</label>
                <input pInputText id="weaknesses" formControlName="weaknesses" class="w-full" [placeholder]="'HRM.RECRUITING.INTERVIEW.COMMA_SEPARATED' | translate" />
            </div>

            <div class="field">
                <label for="feedback" class="font-medium">{{ 'HRM.RECRUITING.INTERVIEW.COMMENT' | translate }} *</label>
                <textarea pTextarea id="feedback" formControlName="feedback" rows="4" class="w-full"></textarea>
            </div>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayInterviewFeedbackDialog = false"></button>
        <button pButton [label]="'COMMON.SAVE' | translate" icon="pi pi-check" (click)="saveFeedback()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог отправки оффера -->
<p-dialog
    [(visible)]="displayOfferDialog"
    [header]="'HRM.RECRUITING.OFFER.SEND_OFFER' | translate"
    [modal]="true"
    [style]="{ width: '500px' }"
    [closable]="true">
    <form [formGroup]="offerForm" class="p-4">
        <div class="grid grid-cols-1 gap-4">
            <div class="field">
                <label for="offered_salary" class="font-medium">{{ 'HRM.RECRUITING.OFFER.OFFERED_SALARY' | translate }} *</label>
                <p-inputNumber id="offered_salary" formControlName="offered_salary" class="w-full"></p-inputNumber>
            </div>

            <div class="field">
                <label for="start_date" class="font-medium">{{ 'HRM.RECRUITING.OFFER.START_DATE' | translate }} *</label>
                <p-date-picker id="start_date" formControlName="start_date" [showIcon]="true" class="w-full"></p-date-picker>
            </div>

            <div class="field">
                <label for="probation" class="font-medium">{{ 'HRM.RECRUITING.OFFER.PROBATION_MONTHS' | translate }} *</label>
                <p-inputNumber id="probation" formControlName="probation_period_months" class="w-full"></p-inputNumber>
            </div>

            <div class="field">
                <label for="benefits" class="font-medium">{{ 'HRM.RECRUITING.OFFER.BENEFITS' | translate }}</label>
                <input pInputText id="benefits" formControlName="benefits" class="w-full" [placeholder]="'HRM.RECRUITING.OFFER.BENEFITS_PLACEHOLDER' | translate" />
            </div>

            <div class="field">
                <label for="other_terms" class="font-medium">{{ 'HRM.RECRUITING.OFFER.OTHER_TERMS' | translate }}</label>
                <textarea pTextarea id="other_terms" formControlName="other_terms" rows="3" class="w-full"></textarea>
            </div>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayOfferDialog = false"></button>
        <button pButton [label]="'HRM.RECRUITING.OFFER.SEND_OFFER_BTN' | translate" icon="pi pi-send" (click)="sendOffer()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог добавления рекомендации -->
<p-dialog
    [(visible)]="displayReferenceDialog"
    [header]="'HRM.RECRUITING.REFERENCE.ADD_REFERENCE' | translate"
    [modal]="true"
    [style]="{ width: '500px' }"
    [closable]="true">
    <form [formGroup]="referenceForm" class="p-4">
        <div class="grid grid-cols-1 gap-4">
            <div class="field">
                <label for="referee_name" class="font-medium">{{ 'HRM.RECRUITING.REFERENCE.REFEREE_NAME' | translate }} *</label>
                <input pInputText id="referee_name" formControlName="referee_name" class="w-full" />
            </div>

            <div class="field">
                <label for="referee_position" class="font-medium">{{ 'HRM.RECRUITING.REFERENCE.REFEREE_POSITION' | translate }} *</label>
                <input pInputText id="referee_position" formControlName="referee_position" class="w-full" />
            </div>

            <div class="field">
                <label for="referee_company" class="font-medium">{{ 'HRM.RECRUITING.REFERENCE.REFEREE_COMPANY' | translate }} *</label>
                <input pInputText id="referee_company" formControlName="referee_company" class="w-full" />
            </div>

            <div class="field">
                <label for="referee_phone" class="font-medium">{{ 'COMMON.PHONE' | translate }} *</label>
                <input pInputText id="referee_phone" formControlName="referee_phone" class="w-full" />
            </div>

            <div class="field">
                <label for="relationship" class="font-medium">{{ 'HRM.RECRUITING.REFERENCE.RELATIONSHIP' | translate }} *</label>
                <input pInputText id="relationship" formControlName="relationship" class="w-full" [placeholder]="'HRM.RECRUITING.REFERENCE.RELATIONSHIP_PLACEHOLDER' | translate" />
            </div>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayReferenceDialog = false"></button>
        <button pButton [label]="'COMMON.ADD' | translate" icon="pi pi-check" (click)="addReference()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог отклонения кандидата -->
<p-dialog
    [(visible)]="displayRejectDialog"
    [header]="'HRM.RECRUITING.REJECT.REJECT_CANDIDATE' | translate"
    [modal]="true"
    [style]="{ width: '450px' }"
    [closable]="true">
    <form [formGroup]="rejectForm" class="p-4">
        <div class="mb-4">
            <p>{{ 'HRM.RECRUITING.REJECT.CONFIRM_MESSAGE' | translate }} <strong>{{ selectedCandidate?.full_name }}</strong>?</p>
            <p class="text-sm text-gray-500 mt-2">{{ 'HRM.RECRUITING.REJECT.NOTIFICATION_INFO' | translate }}</p>
        </div>
        <div class="field">
            <label for="rejection_reason" class="font-medium">{{ 'HRM.RECRUITING.REJECT.REASON' | translate }} *</label>
            <textarea pTextarea id="rejection_reason" formControlName="rejection_reason" rows="3" class="w-full"
                      [placeholder]="'HRM.RECRUITING.REJECT.REASON_PLACEHOLDER' | translate"></textarea>
        </div>
    </form>
    <ng-template #footer>
        <button pButton [label]="'COMMON.CANCEL' | translate" icon="pi pi-times" class="p-button-text" (click)="displayRejectDialog = false"></button>
        <button pButton [label]="'HRM.RECRUITING.REJECT.REJECT' | translate" icon="pi pi-times" class="p-button-danger" (click)="rejectCandidate()"></button>
    </ng-template>
</p-dialog>

<!-- Диалог задач адаптации -->
<p-dialog
    [(visible)]="displayOnboardingDialog"
    [header]="('HRM.RECRUITING.ONBOARDING.TASKS_HEADER' | translate) + ': ' + (selectedOnboarding?.employee_name || '')"
    [modal]="true"
    [style]="{ width: '600px' }"
    [closable]="true">
    @if (selectedOnboarding) {
        <div class="p-4">
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="font-medium">{{ 'HRM.RECRUITING.ONBOARDING.OVERALL_PROGRESS' | translate }}</span>
                    <span>{{ selectedOnboarding.overall_progress }}%</span>
                </div>
                <p-progressBar [value]="selectedOnboarding.overall_progress"></p-progressBar>
            </div>

            <div class="space-y-3">
                @for (task of selectedOnboarding.tasks; track task.id) {
                    <div class="flex items-center justify-between border rounded-lg p-3">
                        <div class="flex items-center gap-3">
                            @if (task.status === 'completed') {
                                <i class="pi pi-check-circle text-green-500 text-xl"></i>
                            } @else if (task.status === 'in_progress') {
                                <i class="pi pi-spin pi-spinner text-blue-500 text-xl"></i>
                            } @else {
                                <i class="pi pi-circle text-gray-400 text-xl"></i>
                            }
                            <div>
                                <div [class]="task.status === 'completed' ? 'line-through text-gray-400' : ''">{{ task.title }}</div>
                                <div class="text-xs text-gray-500">
                                    @switch (task.category) {
                                        @case ('documents') { {{ 'HRM.RECRUITING.ONBOARDING.CAT_DOCUMENTS' | translate }} }
                                        @case ('it_setup') { {{ 'HRM.RECRUITING.ONBOARDING.CAT_IT_SETUP' | translate }} }
                                        @case ('training') { {{ 'HRM.RECRUITING.ONBOARDING.CAT_TRAINING' | translate }} }
                                        @case ('introduction') { {{ 'HRM.RECRUITING.ONBOARDING.CAT_INTRODUCTION' | translate }} }
                                        @case ('compliance') { {{ 'HRM.RECRUITING.ONBOARDING.CAT_COMPLIANCE' | translate }} }
                                        @default { {{ task.category }} }
                                    }
                                </div>
                            </div>
                        </div>
                        @if (task.status !== 'completed') {
                            <button pButton
                                    icon="pi pi-check"
                                    class="p-button-rounded p-button-text p-button-success"
                                    (click)="completeOnboardingTask(selectedOnboarding!, task)"
                                    [pTooltip]="'HRM.RECRUITING.ONBOARDING.MARK_COMPLETED' | translate">
                            </button>
                        }
                    </div>
                }
            </div>

            @if (selectedOnboarding.documents_pending && selectedOnboarding.documents_pending.length > 0) {
                <div class="mt-6">
                    <h4 class="font-semibold mb-2">{{ 'HRM.RECRUITING.ONBOARDING.PENDING_DOCUMENTS' | translate }}</h4>
                    <div class="flex flex-wrap gap-2">
                        @for (doc of selectedOnboarding.documents_pending; track doc) {
                            <p-tag [value]="doc" severity="warn"></p-tag>
                        }
                    </div>
                </div>
            }

            @if (selectedOnboarding.documents_submitted && selectedOnboarding.documents_submitted.length > 0) {
                <div class="mt-4">
                    <h4 class="font-semibold mb-2">{{ 'HRM.RECRUITING.ONBOARDING.SUBMITTED_DOCUMENTS' | translate }}</h4>
                    <div class="flex flex-wrap gap-2">
                        @for (doc of selectedOnboarding.documents_submitted; track doc) {
                            <p-tag [value]="doc" severity="success"></p-tag>
                        }
                    </div>
                </div>
            }
        </div>
    }
    <ng-template #footer>
        <button pButton [label]="'COMMON.CLOSE' | translate" icon="pi pi-times" class="p-button-text" (click)="displayOnboardingDialog = false"></button>
    </ng-template>
</p-dialog>
